---
permalink: maintain/changing-nodes-network-configuration.html 
sidebar: sidebar 
keywords: storagegrid, network configuration, node network configuration 
summary: IP 変更ツールを使用して、 1 つ以上のノードのネットワーク設定を変更できます。グリッドネットワークの設定を変更したり、管理ネットワークまたはクライアントネットワークを追加、変更、削除したりできます。 
---
= ノードのネットワーク設定の変更
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
IP 変更ツールを使用して、 1 つ以上のノードのネットワーク設定を変更できます。グリッドネットワークの設定を変更したり、管理ネットワークまたはクライアントネットワークを追加、変更、削除したりできます。

「 passwords.txt 」ファイルが必要です。

* Linux ： * グリッドノードを管理ネットワークまたはクライアントネットワークに初めて追加する際に、ノード構成ファイルの ADMIN_NETWORK_TARGET または CLIENT_network_target を事前に設定していない場合は、ここで設定する必要があります。

使用している Linux オペレーティングシステムでの StorageGRID のインストール手順を参照してください。

* アプライアンス： StorageGRID アプライアンスでは、初回インストール時にクライアントまたは管理ネットワークが StorageGRID アプライアンスインストーラで設定されなかった場合、 IP 変更ツールだけでネットワークを追加することはできません。最初に、必要です xref:placing-appliance-into-maintenance-mode.adoc[アプライアンスをメンテナンスモードにします]をクリックしてリンクを設定し、アプライアンスを通常の動作モードに戻してから、 IP 変更ツールを使用してネットワーク設定を変更します。ネットワークリンクの設定については、使用しているアプライアンスのインストールおよびメンテナンスの手順にある手順 を参照してください。

任意のネットワーク上の 1 つ以上のノードの IP アドレス、サブネットマスク、ゲートウェイ、または MTU 値を変更できます。

クライアントネットワークまたは管理ネットワークからノードを追加または削除することもできます。

* クライアントネットワークまたは管理ネットワークにノードを追加するには、そのネットワーク上の IP アドレス / サブネットマスクをノードに追加します。
* クライアントネットワークまたは管理ネットワークからノードを削除するには、そのネットワーク上のノードの IP アドレス / サブネットマスクを削除します。
+
グリッドネットワークからノードを削除することはできません。




IMPORTANT: IP アドレスの交換はできません。グリッドノード間で IP アドレスを交換する必要がある場合は、一時的な中間 IP アドレスを使用する必要があります。


IMPORTANT: StorageGRID システムでシングルサインオン（ SSO ）が有効になっている場合、管理ノードの IP アドレスを変更すると、（推奨される完全修飾ドメイン名ではなく）管理ノードの IP アドレスを使用して設定された証明書利用者信頼はすべて無効になります。ノードにサインインできなくなります。IP アドレスを変更したら、すぐに Active Directory フェデレーションサービス（ AD FS ）でそのノードの証明書利用者信頼を新しい IP アドレスで更新または再設定する必要があります。StorageGRID の管理手順を参照してください。


NOTE: IP 変更ツールを使用してネットワークに加えた変更は、 StorageGRID アプライアンスのインストーラファームウェアに反映されます。そのため、アプライアンスに StorageGRID ソフトウェアを再インストールした場合や、アプライアンスをメンテナンスモードにした場合も、正しいネットワーク設定が適用されます。

.手順
. プライマリ管理ノードにログインします。
+
.. 次のコマンドを入力します。 ssh admin@_primary_Admin_Node_IP_`
.. 「 passwords.txt 」ファイルに記載されたパスワードを入力します。
.. root に切り替えるには、次のコマンドを入力します
.. 「 passwords.txt 」ファイルに記載されたパスワードを入力します。
+
root としてログインすると、プロンプトは「 $` 」から「 #」 に変わります。



. 次のコマンドを入力して IP 変更ツールを起動します :'change-ip
. プロンプトでプロビジョニングパスフレーズを入力します。
+
メインメニューが表示されます。

+
image::../media/change_ip_tool_main_menu.png[IP 変更ツールの開始画面のスクリーンショット]

. オプションで * 1 * を選択して、更新するノードを選択します。次に、次のいずれかのオプションを選択します。
+
** *1 * ：シングルノード -- 名前で選択
** * 2 * ：単一ノード -- サイトで選択してから名前で選択します
** *3: シングルノード -- 現在の IP で選択
** * 4 * ：サイト内のすべてのノード
** * 5 * ：グリッド内のすべてのノード
+
* 注： * すべてのノードを更新する場合は、「 all 」が選択されたままにしておきます。



+
選択を行うと、メインメニューが表示され、 [ 選択したノード * （ Selected nodes * ） ] フィールドが更新されて選択内容が反映されます。以降のすべての操作は、表示されているノードでのみ実行されます。

. メインメニューでオプション * 2 * を選択し、選択したノードの IP / マスク、ゲートウェイ、および MTU 情報を編集します。
+
.. 変更するネットワークを選択します。
+
*** * 1 * ：グリッドネットワーク
*** * 2 * ：管理ネットワーク
*** *3 *: クライアントネットワーク
*** * 4 * ：すべてのネットワークを選択すると、ノード名、ネットワーク名（ Grid 、 Admin 、または Client ）、データタイプ（ IP / マスク、 ゲートウェイ（ MTU ）、および現在の値。


+
DHCP によって設定されたインターフェイスの IP アドレス、プレフィックス長、ゲートウェイ、または MTU を編集すると、インターフェイスが static に変更されます。DHCP によって設定されたインターフェイスを変更するように選択すると、インターフェイスが static に変更されることを通知する警告が表示されます。



+
「 fixed 」に設定されているインターフェイスは編集できません。

+
.. 新しい値を設定するには、現在の値の形式で入力します。
.. 現在の値を変更しない場合は、 *Enter* キーを押します。
.. データタイプが「 IP / マスク」の場合は、「 * d * 」または「 * 0.0.0.0/0 * 」と入力することで、ノードから管理ネットワークまたはクライアントネットワークを削除できます。
.. 変更するすべてのノードを編集したら、「 * q * 」と入力してメインメニューに戻ります。
+
変更内容は、クリアまたは適用されるまで保持されます。



. 次のいずれかのオプションを選択して、変更内容を確認します。
+
** *5*: 変更された項目のみを表示するために分離された出力の編集を表示します。変更は、次の出力例に示すように、緑（追加）または赤（削除）で強調表示されます。
+
image::../media/change_ip_tool_edit_ip_mask_sample_output.png[説明が付随するスクリーンショット]

** *6*: 編集内容を出力に表示し、設定全体を表示します。変更は、緑（追加）または赤（削除）で強調表示されます。
+

NOTE: 一部のコマンドラインインターフェイスでは、追加と削除が取り消し線で示される場合があります。正しく表示されるためには、使用するターミナルクライアントが必要な VT100 エスケープシーケンスをサポートしている必要があります。



. オプション * 7 * を選択して、すべての変更を検証します。
+
この検証により、重なり合うサブネットを使用していないなど、グリッドネットワーク、管理ネットワーク、クライアントネットワークのルールに違反がないことを確認します。

+
この例では、検証でエラーが返されています。

+
image::../media/change_ip_tool_validate_sample_error_messages.gif[説明が付随するスクリーンショット]

+
この例では、検証に合格しています。

+
image::../media/change_ip_tool_validate_sample_passed_messages.gif[説明が付随するスクリーンショット]

. 検証に合格したら、次のいずれかのオプションを選択します。
+
** *8*: 適用されていない変更を保存します。
+
このオプションを使用すると、適用されていない変更を失うことなく、 IP 変更ツールを終了してあとで再起動できます。

** *10*: 新しいネットワーク設定を適用します。


. オプション * 10 * を選択した場合は、次のいずれかのオプションを選択します。
+
** * apply * ：必要に応じて、変更をただちに適用し、各ノードを自動的に再起動します。
+
新しいネットワーク設定で物理的な変更が不要な場合は、 *apply * を選択して、変更をすぐに適用できます。必要に応じて、ノードが自動的に再起動されます。再起動が必要なノードが表示されます。

** * stage * ：ノードが次回手動で再起動されるときに変更を適用します。
+
新しいネットワーク構成を機能させるためにネットワーク構成を物理的または仮想的に変更する必要がある場合は、 * stage * オプションを使用して影響を受けるノードをシャットダウンし、必要な物理ネットワーク変更を行って、影響を受けるノードを再起動する必要があります。これらのネットワーク変更を行わずに [*apple] を選択すると、通常、変更は失敗します。

+

IMPORTANT: stage * オプションを使用する場合は、システムの停止を最小限に抑えるためにステージング後すぐにノードを再起動する必要があります。

** * キャンセル * ：現時点ではネットワークに変更を加えないでください。
+
提案した変更がノードの再起動を必要とするかどうかが不明である場合は、ユーザへの影響を最小限に抑えるために変更を延期できます。「 * CANCEL * 」を選択すると、メインメニューに戻り、変更内容が保持されるので、後で適用できます。

+
apply * または * stage * を選択すると、新しいネットワーク構成ファイルが生成され、プロビジョニングが実行され、ノードが新しい作業情報で更新されます。

+
プロビジョニング中に、更新が適用されたときのステータスが出力に表示されます。

+
[listing]
----
Generating new grid networking description file...

Running provisioning...

Updating grid network configuration on Name
----


+
変更を適用またはステージングすると、グリッド設定の変更を受けて新しいリカバリパッケージが生成されます。

. 「 * stage * 」を選択した場合は、プロビジョニングが完了したあとに次の手順を実行します。
+
.. ネットワークに対して必要な物理的または仮想的な変更を行います。
+
* 物理ネットワークの変更 * ：必要に応じて、物理ネットワークに変更を加え、ノードを安全にシャットダウンします。

+
*Linux*: ノードを初めて管理ネットワークまたはクライアントネットワークに追加する場合は、「既存のノードへのインターフェイスの追加」の説明に従って、インターフェイスが追加されていることを確認してください。

.. 影響を受けたノードを再起動します。


. 変更が完了したら、「 *0 」を選択して IP 変更ツールを終了します。
. Grid Manager から新しいリカバリパッケージをダウンロードします。
+
.. [* maintenance * （メンテナンス） ] > [* System * （システム * ） ] > [* Recovery packツケ （リカバリパッケージ * ）
.. プロビジョニングパスフレーズを入力します。




xref:linux-adding-interfaces-to-existing-node.adoc[Linux ：既存のノードにインターフェイスを追加]

xref:../rhel/index.adoc[Red Hat Enterprise Linux または CentOS をインストールします]

xref:../ubuntu/index.adoc[Ubuntu または Debian をインストールします]

xref:../sg100-1000/index.adoc[SG100 および SG1000 サービスアプライアンス]

xref:../sg6000/index.adoc[SG6000 ストレージアプライアンス]

xref:../sg5700/index.adoc[SG5700 ストレージアプライアンス]

xref:../admin/index.adoc[StorageGRID の管理]

xref:configuring-ip-addresses.adoc[IP アドレスを設定する]
