---
permalink: monitor/monitoring-storage-capacity.html 
sidebar: sidebar 
keywords: how to monitor storage capacity 
summary: 使用可能な合計スペースを監視して、 StorageGRID システムのオブジェクトまたはオブジェクトメタデータのストレージスペースが不足しないようにします。 
---
= ストレージ容量を監視
:icons: font
:imagesdir: ../media/


[role="lead"]
使用可能な合計スペースを監視して、 StorageGRID システムのオブジェクトまたはオブジェクトメタデータのストレージスペースが不足しないようにします。

StorageGRID は、オブジェクトデータとオブジェクトメタデータを別々に格納し、オブジェクトメタデータを含む分散 Cassandra データベース用に一定量のスペースをリザーブします。オブジェクトとオブジェクトメタデータ用に消費されるスペースの合計量のほか、それぞれので消費されるスペースの傾向を監視します。これにより、ノードの追加を事前に計画し、サービスの停止を回避できます。

可能です xref:viewing-storage-tab.adoc[ストレージ容量の情報を表示します] グリッド全体、各サイト、および StorageGRID システム内の各ストレージノード。



== グリッド全体のストレージ容量を監視します

グリッドの全体的なストレージ容量を監視して、オブジェクトデータおよびオブジェクトメタデータ用に十分な空きスペースが残っていることを確認する必要があります。時間の経過に伴うストレージ容量の変化を理解しておくと、グリッドの使用可能なストレージ容量が消費される前にストレージノードまたはストレージボリュームを追加する際に役立ちます。

を使用して Grid Manager にサインインします xref:../admin/web-browser-requirements.adoc[サポートされている Web ブラウザ]。

Grid Manager のダッシュボードを使用して、グリッド全体および各データセンターで使用可能なストレージの量を簡単に評価できます。ノードページには、オブジェクトデータとオブジェクトメタデータの詳細な値が表示されます。

.手順
. グリッド全体および各データセンターで使用可能なストレージ容量を評価します。
+
.. 「 * ダッシュボード * 」を選択します。
.. Available Storage （使用可能なストレージ）パネルで、空きストレージ容量と使用済みストレージ容量の概要を確認します。
+

NOTE: アーカイブメディアはこの概要に含まれません。

+
image::../media/dashboard_available_storage_panel.png[Available Storage （使用可能なストレージ）パネル]

.. グラフの「 Free 」または「 Used 」セクションにカーソルを合わせて、正確な空きスペース量または使用済みスペース量を確認します。
+
image::../media/storage_capacity_used.gif[ダッシュボードの空き容量 / 使用済み容量のグラフ]

.. マルチサイトグリッドの場合は、各データセンターのグラフを確認します。
.. グラフアイコンをクリックします image:../media/icon_chart_new_for_11_5.png["グラフアイコン"] をクリックして、使用容量の推移を示すグラフを表示します。
+
使用済みストレージ容量の割合（ % ）と時刻が表示されます。



. ストレージの使用済み容量と、オブジェクトデータおよびオブジェクトメタデータに使用可能な残りのストレージ容量を確認します。
+
.. [* nodes （ノード） ] を選択します
.. [*_grid_*>*Storage*] を選択します。
+
image::../media/nodes_deployment_storage_tab.png[Nodes Deployment Storage タブ]

.. カーソルを「 * Storage Used - object data 」グラフと「 Storage Used - object metadata 」グラフに合わせると、グリッド全体で使用可能なオブジェクトストレージとオブジェクトメタデータストレージの量、および一定期間にわたる使用済みの容量が表示されます。
+

NOTE: サイトまたはグリッドの合計値には、オフラインノードなど、指標が報告されていないノードは 5 分以上含まれません。



. グリッドの使用可能なストレージ容量がすべて使用される前に、ストレージノードまたはストレージボリュームを追加する拡張を実行します。
+
拡張のタイミングを計画する際には、追加のストレージを調達して設置するのにどれくらいの時間がかかるかを検討します。

+

NOTE: ILM ポリシーでイレイジャーコーディングを使用している場合は、既存のストレージノードの使用率が約 70% のときに拡張して、追加する必要のあるノードの数を減らすことができます。

+
ストレージ拡張の計画の詳細については、を参照してください xref:../expand/index.adoc[StorageGRID の拡張手順]。





== 各ストレージノードのストレージ容量を監視します

各ストレージノードの使用可能な合計スペースを監視して、ノードに新しいオブジェクトデータ用の十分なスペースがあることを確認します。

.必要なもの
* を使用して Grid Manager にサインインします xref:../admin/web-browser-requirements.adoc[サポートされている Web ブラウザ]。


使用可能なスペースは、オブジェクトの格納に使用できるストレージスペースの量です。ストレージノードの使用可能な合計スペースは、ノード内のすべてのオブジェクトストアの使用可能なスペースの合計です。

image::../media/calculating_watermarks.gif[Total Usable Space の概念図]

.手順
. ノード * > * _ ストレージノード _ * > * ストレージ * を選択します。
+
ノードのグラフと表が表示されます。

. Storage Used - Object データグラフにカーソルを合わせます。
+
次の値が表示されます。

+
** * Used （ % ） * ：オブジェクトデータに使用されている合計使用可能スペースの割合。
** * Used * ：オブジェクトデータに使用されている合計使用可能スペースの量。
** * Replicated data * ：このノード、サイト、またはグリッド上のレプリケートオブジェクトデータの推定量。
** * イレイジャーコーディングデータ * ：このノード、サイト、またはグリッドにあるイレイジャーコーディングオブジェクトデータの推定量。
** * Total * ：このノード、サイト、またはグリッドで使用可能なスペースの総容量。使用される値は 'storagegrid_storage_utilization_data_bytes メトリックです


+
image::../media/nodes_page_storage_used_object_data.png[Nodes ページ - ストレージの使用済みオブジェクトデータ]

. グラフの下の Volumes テーブルと Object Stores テーブルで使用可能な値を確認します。
+

NOTE: これらの値のグラフを表示するには、グラフアイコンをクリックします image:../media/icon_chart_new_for_11_5.png["グラフアイコン"] をクリックします。

+
image::../media/nodes_page_storage_tables.png[オブジェクトはテーブルを格納します]

. 一定期間の値を監視して、使用可能なストレージスペースが消費される速度を見積もります。
. システムの正常な運用を維持するには、使用可能なスペースを使い切る前に、ストレージノードを追加するか、ストレージボリュームを追加するか、オブジェクトデータをアーカイブします。
+
拡張のタイミングを計画する際には、追加のストレージを調達して設置するのにどれくらいの時間がかかるかを検討します。

+

NOTE: ILM ポリシーでイレイジャーコーディングを使用している場合は、既存のストレージノードの使用率が約 70% のときに拡張して、追加する必要のあるノードの数を減らすことができます。

+
ストレージ拡張の計画の詳細については、を参照してください xref:../expand/index.adoc[StorageGRID の拡張手順]。

+
。 xref:troubleshooting-storagegrid-system.adoc[* 低オブジェクトデータストレージ *] アラートは、ストレージノードにオブジェクトデータを格納するための十分なスペースが残っていない場合にトリガーされます。





== 各ストレージノードのオブジェクトメタデータ容量を監視します

各ストレージノードのメタデータ使用量を監視して、重要なデータベース処理に使用できるスペースが十分に残っていることを確認します。オブジェクトメタデータが許容されるメタデータスペースの 100% を超える前に、各サイトに新しいストレージノードを追加する必要があります。

.必要なもの
* を使用して Grid Manager にサインインします xref:../admin/web-browser-requirements.adoc[サポートされている Web ブラウザ]。


StorageGRID は、冗長性を確保し、オブジェクトメタデータを損失から保護するために、各サイトでオブジェクトメタデータのコピーを 3 つ保持します。3 つのコピーは、各ストレージノードのストレージボリューム 0 でメタデータ用にリザーブされたスペースを使用して、各サイトのすべてのストレージノードに均等に分散されます。

場合によっては、グリッドのオブジェクトメタデータ容量がオブジェクトのストレージ容量よりも早く消費されることがあります。たとえば、一般に大量の小さいオブジェクトを取り込む場合は、オブジェクトストレージの容量が十分に残っている場合でも、ストレージノードを追加してメタデータ容量を増やす必要があります。

メタデータの使用量を増やすことができる要因には、ユーザのメタデータとタグのサイズと数、マルチパートアップロードのパートの合計数、 ILM のストレージの場所に対する変更の頻度などがあります。

.手順
. ノード * > * _ ストレージノード _ * > * ストレージ * を選択します。
. 使用済みストレージオブジェクトのメタデータのグラフにカーソルを合わせると、その時点の値が表示されます。
+
image::../media/storage_used_object_metadata.png[Storage Used - オブジェクトメタデータ]

+
[cols="1a,3a,2a"]
|===
| 価値 | 説明 | Prometheus 指標 


 a| 
使用済み（ % ）
 a| 
このストレージノードで使用されている使用可能なメタデータスペースの割合。
 a| 
「 storagegrid_storage_utilization_metadata_bytes/storagegrid_storage_utilization_allowed_bytes 」



 a| 
使用済み
 a| 
このストレージノードで使用されている使用可能なメタデータスペースのバイト数。
 a| 
「 storagegrid_storage_utilization_metadata_bytes 」というようになりました



 a| 
許可されます
 a| 
このストレージノードでオブジェクトメタデータに使用できるスペース。各ストレージノードの値を決定する方法については、を参照してください xref:../admin/index.adoc[StorageGRID の管理手順]。
 a| 
'storagegrid_storage_utilization_metadata_allowed_bytes'



 a| 
実際の予約
 a| 
このストレージノードでメタデータ用にリザーブされている実際のスペース。使用可能なスペースと重要なメタデータ処理に必要なスペースが含まれます。この値の計算方法については、を参照してください xref:../admin/index.adoc[StorageGRID の管理手順]。
 a| 
_Metric は今後のリリースで追加される予定です。 _

|===
+

NOTE: サイトまたはグリッドの合計値に、指標が報告されていないノード（オフラインノードなど）は含まれません。

. Used （ % ） * 値が 70% 以上の場合は、各サイトにストレージノードを追加して StorageGRID システムを拡張します。
+

IMPORTANT: Low metadata storage * アラートは、「 Used （ % ）」の値が特定のしきい値に達するとトリガーされます。オブジェクトメタデータの使用スペースが使用可能なスペースの 100% を超えている場合、望ましくない結果が生じる可能性があります。

+
新しいノードを追加すると、サイト内のすべてのストレージノード間でオブジェクトメタデータが自動的にリバランシングされます。を参照してください xref:../expand/index.adoc[StorageGRID システムの拡張手順]。


