---
permalink: monitor/monitoring-tenant-activity.html 
sidebar: sidebar 
keywords: how to monitor tenant activity 
summary: すべてのクライアントアクティビティがテナントアカウントに関連付けられている。Grid Manager を使用してテナントのストレージ使用状況やネットワークトラフィックを監視できます。また、監査ログまたは Grafana ダッシュボードを使用して、テナントが StorageGRID を使用している状況に関する詳細情報を収集することもできます。 
---
= テナントのアクティビティを監視する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
すべてのクライアントアクティビティがテナントアカウントに関連付けられている。Grid Manager を使用してテナントのストレージ使用状況やネットワークトラフィックを監視できます。または、監査ログまたは Grafana ダッシュボードを使用して、テナントが StorageGRID を使用している状況に関する詳細情報を収集できます。

.必要なもの
* を使用して Grid Manager にサインインします xref:../admin/web-browser-requirements.adoc[サポートされている Web ブラウザ]。
* Root Access 権限または Administrator 権限が必要です。


.このタスクについて

IMPORTANT: 使用済みスペースの値は推定値です。これらの推定値は、取り込みのタイミング、ネットワーク接続、ノードのステータスによって左右されます。

.手順
. すべてのテナントで使用されているストレージの量を確認するには、「 * tenants * 」を選択します。
+
各テナントの使用済み論理スペース、クォータ利用率、クォータ、オブジェクト数が表示されます。テナントにクォータが設定されていない場合、 Quota Utilization フィールドと Quota フィールドにはダッシュが表示されます（：）。

+
image::../media/tenant_accounts_page.png[テナントアカウントヘエシ]

+
サインインリンクを選択すると、テナントアカウントにサインインできます image:../media/icon_tenant_sign_in.png["テナントのサインインアイコン"] 表の「 * サインイン / URL をコピー * 」列に入力します。

+
URL のコピーリンクを選択して、テナントのサインインページの URL をコピーできます image:../media/icon_tenant_copy_url.png["テナントコピー URL のアイコン"] 表の「 * サインイン / URL をコピー * 」列に入力します。

. 必要に応じて、 * Export to CSV * を選択し、すべてのテナントの使用量の値を含む .csv ファイルを表示およびエクスポートします。
+
「 .csv 」ファイルを開くか保存するように求められます。

+
.csv ファイルの内容は次の例のようになります。

+
image::../media/tenant_accounts_example_csv.png[テナントアカウントの例： .csv]

+
.csv ファイルをスプレッドシートアプリケーションで開くか、自動化で使用できます。

. 使用状況グラフなど、特定のテナントの詳細を表示するには、テナントページからテナントアカウント名を選択します。
+
image::../media/tenant_usage_modal.png[テナント使用モード]

+
** * テナントの概要 *
+
テナントの概要領域には、オブジェクト数、クォータ利用率、使用済み論理スペース、およびクォータ設定の値が表示されます。

** * スペースの内訳 -- スペース消費 *
+
スペース内訳タブには、バケット（ S3 ）またはコンテナ（ Swift ）による合計スペース消費量の値に加え、各バケットまたはコンテナの使用済みスペースとオブジェクト数が表示されます。

+
このテナントにクォータが設定されている場合は ' 使用されているクォータの量と残りのクォータがテキストで表示されます ( たとえば '8500GB の 100 GB 使用済み容量 )クォータが設定されていない場合、テナントには無制限のクォータがあり、テキストには使用されているスペースの量だけが含まれます（たとえば「 85.00 GB Used 」）。棒グラフは、各バケットまたはコンテナのクォータの割合を示します。テナントがストレージクォータを 1% 以上かつ 1GB 以上超過した場合は、クォータの総容量と超過容量がグラフに表示されます。

+
棒グラフにカーソルを合わせると、各バケットまたはコンテナで使用されるストレージを確認できます。空きスペースセグメントにカーソルを合わせると、残りのストレージクォータを確認できます。

+
image::../media/tenant_bucket_space_consumption_GM.png[テナントバケットの消費バーグラフ]

+

IMPORTANT: クォータ使用率は内部の推定値に基づいており、場合によっては超過することがあります。たとえば、テナントがクォータを超えた場合、 StorageGRID はテナントがオブジェクトのアップロードを開始したときにクォータをチェックし、新しい取り込みを拒否します。ただし、 StorageGRID では、クォータを超過したかどうかを判断する際に、現在のアップロードのサイズは考慮されません。オブジェクトが削除された場合、クォータ使用率が再計算されるまでテナントが一時的に新しいオブジェクトをアップロードできなくなることがあります。クォータ使用率の計算には 10 分以上かかることがあります。

+

NOTE: テナントのクォータ利用率は、テナントが StorageGRID にアップロードしたオブジェクトデータの総容量（論理サイズ）を示します。クォータ利用率は、これらのオブジェクトおよびそのメタデータのコピーを格納するために使用されるスペース（物理サイズ）を表していません。

+

NOTE: テナントのクォータ使用率が高い * アラートを有効にすると、テナントがそのクォータを消費しているかどうかを確認できます。有効にすると、テナントのクォータの 90% が使用されたときにこのアラートがトリガーされます。詳細については、アラートリファレンスを参照してください。

** * スペースの内訳 -- バケットまたはコンテナの詳細 *
+
バケットの詳細 * （ S3 ）テーブルまたは * コンテナの詳細 * （ Swift ）テーブルには、テナントのバケットまたはコンテナが表示されます。使用済みスペースは、バケットまたはコンテナ内のオブジェクトデータの総容量です。この値は、 ILM コピーとオブジェクトメタデータに必要なストレージスペースを表しているわけではありません。



. 必要に応じて、「 * Export to CSV * 」を選択し、各バケットまたはコンテナの使用量の値を含む .csv ファイルを表示してエクスポートします。
+
個々の S3 テナントの .csv ファイルの内容は、次の例のようになります。

+
image::../media/tenant_bucket_details_csv.png[テナントバケットの詳細の CSV の例]

+
.csv ファイルをスプレッドシートアプリケーションで開くか、自動化で使用できます。

. テナントにトラフィック分類ポリシーが設定されている場合は、そのテナントのネットワークトラフィックを確認します。
+
.. * configuration * > * Network * > * traffic classification * を選択します。
+
[Traffic Classification Policies] ページが表示され、既存のポリシーがテーブルにリストされます。

+
image::../media/traffic_classification_policies_main_screen_w_examples.png[グラフのトラフィックポリシーの例]

.. ポリシーのリストを確認して、特定のテナントに適用されるポリシーを特定します。
.. ポリシーに関連付けられている指標を表示するには、ポリシーの左側にあるオプションボタンを選択し、 [*Metrics] をクリックします。
.. グラフを分析して、ポリシーがトラフィックを制限している頻度と、ポリシーを調整する必要があるかどうかを判断します。
+
トラフィック分類ポリシーを作成、編集、または削除するには、 StorageGRID の管理手順を参照してください。



. 必要に応じて、監査ログを使用してテナントのアクティビティをより詳細に監視できます。
+
たとえば、次の種類の情報を監視できます。

+
** PUT 、 GET 、 DELETE など、特定のクライアント処理
** オブジェクトサイズ
** オブジェクトに適用されている ILM ルール
** クライアント要求の送信元 IP
+
監査ログは、選択したログ分析ツールを使用して分析可能なテキストファイルに書き込まれます。これにより、クライアントアクティビティをよりよく理解したり、高度なチャージバックおよび課金モデルを実装したりできます。

+
詳細については、監査メッセージを確認する手順を参照してください。



. 必要に応じて、 Prometheus 指標を使用してテナントのアクティビティをレポートします。
+
** Grid Manager で、 * support * > * Tools * > * Metrics * を選択します。S3 の概要など、既存のダッシュボードを使用してクライアントのアクティビティを確認できます。
+

IMPORTANT: Metrics ページで使用できるツールは、主にテクニカルサポートが使用することを目的としています。これらのツールの一部の機能およびメニュー項目は、意図的に機能しないようになっています。

** Grid Manager の上部からヘルプアイコンを選択し、 * API ドキュメント * を選択します。グリッド管理 API の指標セクションの指標を使用して、テナントアクティビティ用のカスタムのアラートルールとダッシュボードを作成できます。




.関連情報
xref:alerts-reference.adoc[アラート一覧]

xref:../audit/index.adoc[監査ログを確認します]

xref:../admin/index.adoc[StorageGRID の管理]

xref:reviewing-support-metrics.adoc[サポート指標を確認]
