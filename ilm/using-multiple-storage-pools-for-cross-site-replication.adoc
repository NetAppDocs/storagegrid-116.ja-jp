---
permalink: ilm/using-multiple-storage-pools-for-cross-site-replication.html 
sidebar: sidebar 
keywords: site-loss protection, cross-site replication, storage pools 
summary: StorageGRID 環境に複数のサイトが含まれている場合は、各サイトにストレージプールを 1 つずつ作成し、ルールの配置手順に両方のストレージプールを指定することで、サイト障害から保護できます。たとえば、 2 つのレプリケートコピーを作成する ILM ルールを設定して、 2 つのサイトのストレージプールを指定すると、各オブジェクトのコピーが各サイトに 1 つずつ配置されます。2 つのコピーを作成するルールを設定して 3 つのストレージプールを指定すると、 2 つのコピーが別々のサイトに格納される際、ストレージプール間のディスク使用量のバランスを保つようにコピーが分散されます。 
---
= 複数のストレージプールを使用してサイト間レプリケーションを行う
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
StorageGRID 環境に複数のサイトが含まれている場合は、各サイトにストレージプールを 1 つずつ作成し、ルールの配置手順に両方のストレージプールを指定することで、サイト障害から保護できます。たとえば、 2 つのレプリケートコピーを作成する ILM ルールを設定して、 2 つのサイトのストレージプールを指定すると、各オブジェクトのコピーが各サイトに 1 つずつ配置されます。2 つのコピーを作成するルールを設定して 3 つのストレージプールを指定すると、 2 つのコピーが別々のサイトに格納される際、ストレージプール間のディスク使用量のバランスを保つようにコピーが分散されます。

次の例は、 ILM ルールによって 2 つのサイトのストレージノードを含む単一のストレージプールにレプリケートオブジェクトコピーが配置された場合にどうなるかを示しています。レプリケートコピーがストレージプール内の使用可能な任意のノードに配置されるため、一部のオブジェクトのすべてのコピーが 1 つのサイト内にのみ配置される可能性があります。この例では、システムはオブジェクト AAA の 2 つのコピーをサイト 1 の別々のストレージノードに、オブジェクト CCC の 2 つのコピーをサイト 2 の別々のストレージノードに格納しています。いずれかのサイトで障害が発生したりアクセスできなくなった場合、保護されるのはオブジェクト BBB だけです。

image::../media/ilm_replication_make_2_copies_1_pool_2_sites.png[ストレージプールが 1 つしかない 2 つのサイトにおける Make 2 Copies ルール]

一方、この例は、複数のストレージプールを使用した場合のオブジェクトの格納方法を示しています。この例の ILM ルールは、各オブジェクトのレプリケートコピーを 2 つ作成して 2 つのストレージプールに分散するように指定されています。各ストレージプールには一方のサイトのすべてのストレージノードが含まれています。各オブジェクトのコピーは各サイトに格納されるため、オブジェクトデータはサイトの障害やサイトへのアクセス障害から保護されます。

image::../media/ilm_replication_make_2_copies_2_pools_2_sites.png[2 つのサイトと 2 つのストレージプールにおける Make 2 Copies ルール]

複数のストレージプールを使用する場合は、次の点に注意してください。

* n 個のコピーを作成する場合は、 n 個以上のストレージプールを追加する必要があります。たとえば、 3 つのコピーを作成するようにルールが設定されている場合は、ストレージプールを 3 つ以上指定する必要があります。
* コピーの数がストレージプールの数と同じ場合は、オブジェクトのコピーが 1 つずつ各ストレージプールに格納されます。
* コピーの数がストレージプールの数より少ない場合、プール間のディスク使用量のバランスを維持し、複数のコピーが同じストレージプールに格納されないようにコピーが分散されます。
* ストレージプールが重複している（同じストレージノードを含んでいる）場合は、オブジェクトのすべてのコピーが 1 つのサイトにのみ保存される可能性があります。選択したストレージプールに同じストレージノードが含まれていないことを確認する必要があります。

