= repair-data スクリプトについて
:allow-uri-read: 


.必要なもの
* リカバリされたストレージノードの接続状態が * connected * であることを確認しておく必要があります image:../media/icon_alert_green_checkmark.png["アイコンアラートの緑のチェックマーク"] Grid Manager の * nodes * > * Overview * タブをクリックします。


.このタスクについて
グリッドの ILM ルールがオブジェクトコピーを作成するように設定されていた場合、他のストレージノード、アーカイブノード、またはクラウドストレージプールからオブジェクトデータをリストアできます。

次の点に注意してください。

* レプリケートされたコピーを 1 つだけ保存するように ILM ルールが設定されていて、そのコピーがストレージボリュームに障害が発生した場合、オブジェクトをリカバリすることはできません。
* オブジェクトのコピーがクラウドストレージプールにしか残っていない場合、 StorageGRID は、オブジェクトデータをリストアするために複数の要求をクラウドストレージプールエンドポイントに問題 する必要があります。この手順 を実行する前に、テクニカルサポートに問い合わせて、リカバリ期間と関連コストの見積もりを依頼してください。
* オブジェクトのコピーがアーカイブノードにしか残っていない場合は、アーカイブノードからオブジェクトデータが読み出されます。アーカイブノードからストレージノードへのオブジェクトデータのリストアでは、外部アーカイブストレージシステムからの読み出しにレイテンシが伴うため、他のストレージノードからコピーをリストアする場合に比べて時間がかかります。




== について `repair-data` スクリプト

オブジェクトデータを復元するには、「 repair-data 」スクリプトを実行します。このスクリプトは、オブジェクトデータのリストアプロセスを開始し、 ILM スキャンと連動して ILM ルールを適用します。

レプリケートデータとイレイジャーコーディングデータのどちらをリストアするかに基づいて 'repair-data' スクリプトのさまざまなオプションを学習するには ' 以下の *Replicated data* または *Erasure-coded (EC) data* を選択します両方のタイプのデータをリストアする必要がある場合は、両方のコマンドセットを実行する必要があります。


NOTE: 「 repair-data 」スクリプトの詳細については、プライマリ管理ノードのコマンドラインで「 repair-data --help 」と入力します。

[role="tabbed-block"]
====
.レプリケートデータ
--
レプリケートデータをリストアするコマンドは、ノード全体を修復するのか、ノード上の一部のボリュームのみを修復するのかに応じて 2 つあります。

「 repair-data start-replicated-node-repair 」

「 repair-data start-replicated-volume-repair 」

レプリケートデータの修復は、次のコマンドで追跡できます。

「 repair-data show-replicated-repair-status 」


IMPORTANT: StorageGRID 11.6 では、「 show -replicated-repair-status 」オプションをテクニカルプレビューで利用できます。この機能は開発中であり、返される値が正しくないか遅れている可能性があります。修理が完了したかどうかを確認するには、 * Awaiting – All * 、 * Repairs Attempted （ XRPA ） * 、 * Scan Period - Estimated （ XSCM ） * （ * スキャン期間 - 推定（ XSCM ）））を使用します（を参照） xref:..//maintain/restoring-object-data-to-storage-volume-where-system-drive-is-intact.adoc[修理を監視する]。

--
.イレイジャーコーディング（ EC ）データ
--
イレイジャーコーディングデータをリストアするコマンドは、ノード全体を修復するのか、ノード上の一部のボリュームのみを修復するのかに応じて 2 つあります。

「 repair-data start-ec-node-repair 」です

「 repair-data start-ec-volume-repair 」のように指定します

イレイジャーコーディングデータの修復は、一部のストレージノードがオフライン状態で開始できます。修復はすべてのノードが使用可能になったあとに完了します。

イレイジャーコーディングデータの修復は、次のコマンドで追跡できます。

「 repair-data show-ec-repair-status 」です


NOTE: EC 修復ジョブによって、大量のストレージが一時的にリザーブされます。ストレージアラートがトリガーされることもありますが、修復が完了すると解決します。予約に必要なストレージが不足していると、 EC の修復ジョブが失敗します。ストレージリザベーションは、ジョブが失敗したか成功したかに関係なく、 EC 修復ジョブが完了すると解放されます。

--
====